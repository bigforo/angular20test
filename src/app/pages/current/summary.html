<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Active Workout</ion-title>

    @if (appState().current?.activities?.length??0>0){
    <ion-buttons slot="end">
      <ion-button id="present-alert">
        <ion-icon size="large" color="danger" name="stop-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
      <ion-alert
        trigger="present-alert"
        header="Are you sure?"
        message="Older workout sessions can be found in the history tab."
        [buttons]="alertButtons"
        (didDismiss)="delete213($event)"
      ></ion-alert>
    }

  </ion-toolbar>
</ion-header>

<ion-content fullscreen="true">
  @if (appState().current?.activities?.length??0>0){

  <div class="about-session">
    <h3 class="ion-padding-top ion-padding-start">Workout session started</h3>

    <p class="ion-padding-start ion-padding-end">
      "Workout sessions are beneficial because they improve physical health, boost mental well-being, increase energy, and enhance overall quality of life!" - ChatGPT
    </p>
  </div>

  <div class="ion-padding-start">
    <ion-chip
      [ngClass]="{ 'selected-chip': selectedBackDay }"
      [outline]="true"
      (click) = "selectedBackDay = !selectedBackDay"
      color="warning">Back Day</ion-chip>
    <ion-chip
      [ngClass]="{ 'selected-chip': selectedShoulderDay }"
      [outline]="true"
      (click)="selectedShoulderDay=!selectedShoulderDay"
      color="warning">Shoulder Day</ion-chip>
    <ion-chip
      [ngClass]="{ 'selected-chip': selectedChestDay }"
      [outline]="true"
      (click)="selectedChestDay=!selectedChestDay"
      color="warning">Chest Day</ion-chip>
  </div>


<!--  <ion-item lines="full">-->
<!--    <ion-select label="Set session type" interface="action-sheet" placeholder="Session type">-->
<!--      <ion-select-option value="chest">Chest day</ion-select-option>-->
<!--      <ion-select-option value="back">Back day</ion-select-option>-->
<!--      <ion-select-option value="shoulders">Shoulders</ion-select-option>-->
<!--      <ion-select-option value="push">Push</ion-select-option>-->
<!--      <ion-select-option value="pull">Pull</ion-select-option>-->
<!--      <ion-select-option value="legs">Legs</ion-select-option>-->
<!--    </ion-select>-->
<!--  </ion-item>-->
  }


<!--  <div>-->
<!--    <h1 class="ion-padding-top ion-padding-start"><ion-text color="primary">Activities</ion-text> </h1>-->
<!--  </div>-->
  @for (activity of appState().current?.activities; track $index) {

    <ion-list>
      <ion-item-sliding #sliding>
        <ion-item lines="full" [routerLink]="'/'+activity.id" >
          <ion-icon aria-hidden="true" name="timer-outline" slot="start"></ion-icon>
          <ion-label>
            <strong class="ion-text-capitalize">{{activity.exercise.name}}</strong>
            <ion-text color="medium">- {{activity.exercise.name}} -</ion-text>
          </ion-label>
          <div class="metadata-end-wrapper" slot="end">
            <ion-note color="medium">{{ activity.created | date:'HH:mm' }}</ion-note>
            <ion-icon color="medium" name="chevron-forward"></ion-icon>
          </div>
        </ion-item>
        <ion-item-options side="end">
<!--          <ion-item-option (click)="edit(activity)">Edit</ion-item-option>-->
          <ion-item-option color="danger" (click)="delete(activity,sliding)">Delete</ion-item-option>
        </ion-item-options>
      </ion-item-sliding>

<!--      <ion-item [button]="true" detail="false">-->
<!--        <div class="unread-indicator-wrapper" slot="start">-->
<!--          <div class="unread-indicator"></div>-->
<!--        </div>-->
<!--        <ion-label>-->
<!--          <strong>Rick Astley</strong>-->
<!--          <ion-text>Never Gonna Give You Up</ion-text><br />-->
<!--          <ion-note color="medium" class="ion-text-wrap">-->
<!--            Never gonna give you up Never gonna let you down Never gonna run...-->
<!--          </ion-note>-->
<!--        </ion-label>-->
<!--        <div class="metadata-end-wrapper" slot="end">-->
<!--          <ion-note color="medium">06:11</ion-note>-->
<!--          <ion-icon color="medium" name="chevron-forward"></ion-icon>-->
<!--        </div>-->
<!--      </ion-item>-->

      @for (i of activity.sets; track $index){
        <ion-item>
<!--          <ion-grid>-->
<!--            <ion-row>-->
<!--              <ion-col color="secondary"> <sub>{{ i.time| date:'HH:mm' }}</sub> </ion-col>-->
<!--              <ion-col color="tertiary"> set {{ $index + 1 }} </ion-col>-->
<!--              <ion-col color="tertiary">-->
<!--                {{i.reps}}-->
<!--                @if (activity.hasSize) {-->
<!--                  {{'x ' + i.size}}{{activity.exercise.weightUnit}}-->
<!--                }</ion-col>-->
<!--            </ion-row>-->
<!--          </ion-grid>-->
          <ion-label color="secondary"> <sub>{{ i.time| date:'HH:mm' }}</sub>  </ion-label>
          <ion-label color="tertiary"> set {{ $index + 1 }} </ion-label>
          <ion-label color="tertiary">
            {{i.reps}}
            @if (activity.hasSize) {
              {{'x ' + i.size}}{{activity.exercise.weightUnit}}
            }
          </ion-label>
        </ion-item>
      }
    </ion-list>
  }


  @if (appState().current?.activities?.length??0>0){
    <ion-list [inset]="true">
      <ion-item>
        <ion-textarea (ionChange)="change($event)" [value]="appState().current?.note" label="Comments" labelPlacement="floating" rows="5"></ion-textarea>
      </ion-item>
    </ion-list>
  }

<!--  @if (appState().current?.activities?.length??0>0){-->
<!--    <ion-button expand="full" id="present-alert">Finish Session</ion-button>-->
<!--  }-->




</ion-content>
@if ( (appState().current?.activities?.length ?? 0) === 0){
<ion-footer id="footer">
  <ion-toolbar >
      <div class="ion-text-center">
        <ion-note>No session started</ion-note>
      </div>
      <div class="ion-text-center">
        <ion-note color="warning">To start Workout Session select Exercise</ion-note>
      </div>

  </ion-toolbar>
</ion-footer>
}
